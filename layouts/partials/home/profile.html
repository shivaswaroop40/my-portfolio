{{ $disableImageOptimization := .Site.Params.disableImageOptimization | default false }}
<article
  class="{{ if not .Site.Params.homepage.showRecent }}
    h-full
  {{ end }} flex flex-col items-center justify-center">
  
  <!-- Custom horizontal layout with name on left, image on right -->
  <header class="relative px-1 py-1 mb-3 w-full max-w-5xl">
    <div class="flex items-start justify-center gap-10">
      
      <!-- Left side: Name and info -->
      <div class="flex-1 text-left max-w-lg">
        <h1 class="text-4xl font-extrabold mb-2">
          {{ .Site.Params.Author.name | default .Site.Title }}
        </h1>
        {{ with .Site.Params.Author.headline }}
          <h2 class="text-xl text-neutral-500 dark:text-neutral-400 mb-4">
            {{ . | markdownify }}
          </h2>
        {{ end }}
        <div class="text-2xl">
          {{ partialCached "author-links.html" . }}
        </div>
      </div>
      
      <!-- Right side: Larger square image -->
      {{ with .Site.Params.Author.image }}
        {{ $authorImage := "" }}
        {{ if or (strings.HasPrefix . "http:") (strings.HasPrefix . "https:") }}
          {{ $authorImage = resources.GetRemote . }}
        {{ else }}
          {{ $authorImage = resources.Get . }}
        {{ end }}
        {{ if $authorImage }}
          {{ if not $disableImageOptimization }}
            {{ $authorImage = $authorImage.Fill (print "384x384 q" ( $.Site.Params.Author.imagequality | default "96" )) }}
          {{ end }}
          <div class="flex-shrink-0">
            <img
              class="h-48 w-48 object-cover border-3 border-neutral-300 dark:border-neutral-600"
              width="192"
              height="192"
              alt="{{ $.Site.Params.Author.name | default "Author" }}"
              src="{{ $authorImage.RelPermalink }}">
          </div>
        {{ end }}
      {{ end }}
      
    </div>
  </header>
  
  <section class="prose dark:prose-invert">{{ .Content }}</section>

  <!-- My Story headline pulled from posts/my-first-post.md -->
  {{ $post := site.GetPage "posts/my-first-post" }}
  {{ with $post }}
    {{ $content := .Content }}
    {{/* Capture content between '## My Story' and the next '## ' heading */}}
    {{ $matches := findRE "(?s)##\\s*My Story\\s*(.*?)\\n##" $content }}
    {{ $story := "" }}
    {{ if gt (len $matches) 0 }}
      {{ $story = index $matches 0 }}
      {{/* Strip the leading heading line from the captured block */}}
      {{ $story = replaceRE "(?s)^##\\s*My Story\\s*" "" $story }}
    {{ else }}
      {{/* Fallback to entire post summary if section match not found */}}
      {{ $story = .Summary }}
    {{ end }}
    <section class="w-full max-w-5xl mt-8">
      <h3 class="text-xl font-semibold mb-2">My Story</h3>
      <div class="prose dark:prose-invert">
        {{ $story | safeHTML }}
      </div>
      <div class="mt-3">
        <a class="text-primary-600 dark:text-primary-400 hover:underline" href="{{ .RelPermalink }}">Read the full story →</a>
      </div>
    </section>
  {{ end }}

  <!-- Highlights: Education and Experience -->
  <section class="w-full max-w-5xl mt-6 grid gap-4 sm:grid-cols-2">
    <div class="rounded-lg border border-neutral-200 dark:border-neutral-700 p-4">
      <h3 class="text-lg font-semibold mb-2">Education</h3>
      {{ with site.GetPage "/education" }}
        <p class="text-neutral-600 dark:text-neutral-400 mb-2">{{ .Params.description | default "Academic background and coursework highlights" }}</p>
        <a class="text-primary-600 dark:text-primary-400 hover:underline" href="{{ .RelPermalink }}">View education →</a>
      {{ end }}
    </div>
    <div class="rounded-lg border border-neutral-200 dark:border-neutral-700 p-4">
      <h3 class="text-lg font-semibold mb-2">Experience</h3>
      {{ with site.GetPage "/experience" }}
        <p class="text-neutral-600 dark:text-neutral-400 mb-2">{{ .Params.description | default "Professional roles and accomplishments" }}</p>
        <a class="text-primary-600 dark:text-primary-400 hover:underline" href="{{ .RelPermalink }}">View experience →</a>
      {{ end }}
    </div>
  </section>
</article>
<section>
  {{ partial "recent-articles/main.html" . }}
</section>
